<?php require_once __DIR__ . '/../locale.php'; ?>
<div class="navigation">
    <div class="navigation-menu">
        <ul>
            <li><a href="index.php"><i class="fa fa-tachometer"></i><span><?php echo _('Dashboard'); ?></span></a>
            </li>
            <li><a href="target_list.php"><i class="fa fa-server"></i><span><?php echo _('Target Hosts'); ?></span></a>
            </li>
            <li><a href="host_manager.php"><i
                        class="fa fa-server"></i><span><?php echo _('Manager Hosts'); ?></span></a></li>
            <li><a href="packageResult.php"><i class="fa fa-list-alt"></i><span><?php echo _('Package logs'); ?></span></a></li>
            <li><a href="logger.php"><i class="fa fa-list-alt"></i><span><?php echo _('Error logs'); ?></span></a></li>
            <li><a href="profile.php"><i class="fa fa-cog"></i><span><?php echo _('Settings'); ?></span></a></li>
        </ul>
    </div>
</div>
<div class="topbar">
    <div class="topbar-inner clearfix">
        <i class="fa fa-bars navigation-toggle"></i>
        <div class="topbar-title">
            <img src="../images/eisen.png" style="height:28px; width:auto;">
            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                 preserveAspectRatio="xMidYMid" viewBox="0 0 172.594 54.969"
                 class="eisen-logo">
                <path
                    d="M166.687,54.344 L166.687,29.095 C166.687,26.057 166.358,24.101 165.702,23.225 C165.046,22.350 164.267,21.760 163.365,21.454 C162.462,21.148 161.284,20.995 159.831,20.995 C155.261,20.995 150.608,22.208 145.874,24.633 L145.874,54.344 L140.038,54.344 L140.038,16.692 L145.171,16.692 L145.734,20.583 C148.288,18.706 151.464,17.367 155.261,16.565 C156.808,16.228 158.624,16.059 160.710,16.059 C162.796,16.059 164.636,16.275 166.230,16.707 C167.823,17.140 169.089,17.831 170.027,18.780 C171.737,20.489 172.593,23.600 172.593,28.114 L172.593,54.344 L166.687,54.344 ZM121.927,37.480 L116.267,37.480 C110.361,37.480 105.814,37.248 102.627,36.783 C102.627,41.635 103.306,45.021 104.666,46.940 C106.329,49.282 109.646,50.452 114.615,50.452 C119.583,50.452 124.341,49.577 128.888,47.826 L130.611,52.351 C125.759,54.102 120.403,54.977 114.544,54.977 C111.146,54.977 108.263,54.660 105.896,54.028 C102.122,53.058 99.615,51.053 98.373,48.016 C97.224,45.168 96.650,40.950 96.650,35.360 L96.650,33.746 C96.650,27.059 98.197,22.366 101.291,19.666 C104.079,17.261 108.732,16.059 115.248,16.059 C121.599,16.059 125.935,17.472 128.255,20.299 C129.380,21.670 130.124,23.331 130.488,25.282 C130.851,27.233 131.033,29.095 131.033,30.867 C131.033,33.630 130.962,35.771 130.822,37.290 C127.517,37.416 124.552,37.480 121.927,37.480 ZM125.091,30.044 C125.091,26.733 124.376,24.370 122.947,22.957 C121.353,21.374 118.599,20.583 114.685,20.583 C109.997,20.583 106.798,21.501 105.087,23.336 C103.447,25.087 102.627,28.335 102.627,33.082 L125.091,33.082 L125.091,30.044 ZM74.672,32.559 C76.922,32.823 78.761,33.055 80.191,33.256 C81.621,33.456 82.921,33.725 84.094,34.062 C85.265,34.400 86.273,34.938 87.117,35.676 C88.875,37.174 89.730,39.779 89.683,43.491 C89.566,49.967 86.566,53.659 80.683,54.565 C78.902,54.839 77.121,54.977 75.340,54.977 C73.558,54.977 71.923,54.876 70.435,54.676 C68.947,54.476 67.523,54.197 66.164,53.838 C63.585,53.184 61.254,52.319 59.168,51.243 L61.699,46.877 C66.527,49.303 71.379,50.515 76.254,50.515 C80.308,50.515 82.687,49.218 83.390,46.624 C83.624,45.738 83.742,44.657 83.742,43.381 C83.742,42.105 83.578,41.113 83.250,40.406 C82.921,39.700 82.371,39.172 81.597,38.824 C80.824,38.476 79.798,38.218 78.521,38.049 C77.244,37.880 75.621,37.643 73.652,37.337 C71.683,37.032 69.878,36.689 68.238,36.309 C66.597,35.929 65.203,35.381 64.054,34.664 C61.617,33.124 60.445,30.529 60.539,26.880 L60.539,26.089 C60.539,22.250 61.945,19.519 64.758,17.894 C67.476,16.291 71.965,15.742 78.222,16.249 C82.488,16.608 85.886,17.272 88.418,18.242 L86.765,23.020 C83.953,21.944 80.578,21.164 76.640,20.678 C75.421,20.531 74.279,20.457 73.213,20.457 C72.146,20.457 71.179,20.531 70.312,20.678 C69.445,20.826 68.718,21.101 68.133,21.501 C67.008,22.324 66.421,23.853 66.375,26.089 C66.304,28.726 67.125,30.403 68.836,31.120 C70.476,31.816 72.422,32.296 74.672,32.559 ZM50.725,6.883 C50.139,7.411 49.084,7.674 47.561,7.674 C45.990,7.674 44.982,7.474 44.537,7.073 C43.834,6.419 43.482,5.518 43.482,4.368 C43.482,3.218 43.558,2.396 43.711,1.900 C43.863,1.404 44.092,1.019 44.397,0.745 C44.959,0.239 45.820,-0.015 46.980,-0.015 C48.141,-0.015 48.972,0.038 49.477,0.144 C49.980,0.249 50.396,0.450 50.725,0.745 C51.287,1.251 51.568,2.079 51.568,3.229 C51.568,4.379 51.504,5.201 51.375,5.697 C51.246,6.192 51.029,6.588 50.725,6.883 ZM25.266,37.480 L19.606,37.480 C13.699,37.480 9.152,37.248 5.965,36.783 C5.965,41.635 6.645,45.021 8.004,46.940 C9.668,49.282 12.984,50.452 17.953,50.452 C22.922,50.452 27.680,49.577 32.227,47.826 L33.949,52.351 C29.098,54.102 23.742,54.977 17.883,54.977 C14.484,54.977 11.602,54.660 9.235,54.028 C5.461,53.058 2.953,51.053 1.711,48.016 C0.563,45.168 -0.011,40.950 -0.011,35.360 L-0.011,33.746 C-0.011,27.059 1.535,22.366 4.629,19.666 C7.418,17.261 12.070,16.059 18.586,16.059 C24.937,16.059 29.274,17.472 31.594,20.299 C32.719,21.670 33.463,23.331 33.826,25.282 C34.190,27.233 34.371,29.095 34.371,30.867 C34.371,33.630 34.301,35.771 34.160,37.290 C30.856,37.416 27.891,37.480 25.266,37.480 ZM28.430,30.044 C28.430,26.733 27.715,24.370 26.285,22.957 C24.691,21.374 21.938,20.583 18.024,20.583 C13.336,20.583 10.137,21.501 8.426,23.336 C6.785,25.087 5.965,28.335 5.965,33.082 L28.430,33.082 L28.430,30.044 ZM50.479,54.344 L44.783,54.344 L44.713,16.692 L50.479,16.692 L50.479,54.344 Z"
                    class="eisen-logo-cls-1"/>
            </svg>
        </div>
        <div class="menu clearfix">
            <div class="menu-button menu-user menu-border">
                <div class="menu-icon">
                    <i class="fa fa-user"></i>
                    <div class="menu-icon-text">
                        <span>
                            <?php
                                $user_id = $me->get_user_id();
                                if (strcmp($user_id,'logged off')==0){
                                    echo '<script type="text/javascript">
                                    window.location = "login.php"
                                    </script>';
                                    die;
                                }else{
                                    echo $user_id;
                                }
                            ?>
                        </span>
                    </div>
                </div>

                <div class="menu-popup">
                    <div class="popup-title">
                        <i class="fa fa-user fa-inline"></i>
                        <?php
                            $user_id = $me->get_user_id();
                            echo $user_id;
                        ?>
                    </div>
                    <div class="popup-contents">
                        <div class="menu-list-items">
                            <ul class="link-list-fw">
                                <li>
                                    <a href="logout.php"><i
                                            class="fa fa-cog"></i><span><?php echo _('Logout'); ?></span></a>
                                </li>
                                <li>
                                    <a href="profile.php"><i
                                            class="fa fa-cog"></i><span><?php echo _('Settings'); ?></span></a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="menu-button menu-notifications menu-border" id="notification">
                <div class="menu-icon">
                    <i class="fa fa-bell-o"></i>
                </div>
                <div class="menu-popup">
                    <div class="popup-title">
                        <i class="fa fa-bell-o fa-inline"></i><?php echo _('Notifications'); ?>
                    </div>
                    <div class="popup-contents">
                        <div class="menu-list-items">
                            <ul>
                            <?php
                            try {
                                $dba = new DbAction();
                                $dbh = $dba->Connect();
                                $user_id = $me->get_user_id();
                                $packageResult = $dba->packageGetResult($dbh);
                                foreach ($packageResult as $index => $packres) {
                                    $notify = '<li>';
                                    $notify .= '<span class="notifications-machine-name"><pre>' . $packres['targetHost'] . '</pre></span>';
                                    $notify .= '<span class="notifications-time">' . $packres['created_at'] . '</span>';
                                    $notify .= '<span class="notifications-message"><i class="fa fa-check-circle fa-inline"> ' .$packres['packageAction'].' '. $packres['packageName'] . '</i></span>';
                                    $notify .= '</li>';
                                    echo($notify);
                                }
                            } catch (Exception $e) {
                                echo('no activity');
                            }
                            ?>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
